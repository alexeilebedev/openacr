## ams_sendtest - Internals


### Table Of Contents
<a href="#table-of-contents"></a>
<!-- dev.mdmark  mdmark:MDSECTION  state:BEG_AUTO  param:Toc -->
* [Description](#description)
* [Sources](#sources)
* [Dependencies](#dependencies)
* [In Memory DB](#in-memory-db)

<!-- dev.mdmark  mdmark:MDSECTION  state:END_AUTO  param:Toc -->

### Description
<a href="#description"></a>
<!-- dev.mdmark  mdmark:MDSECTION  state:BEG_AUTO  param:Description -->
for usage, see [ams_sendtest - Algo Messaging System test tool](/txt/exe/ams_sendtest/README.md)

<!-- dev.mdmark  mdmark:MDSECTION  state:END_AUTO  param:Description -->

### Sources
<a href="#sources"></a>
<!-- dev.mdmark  mdmark:MDSECTION  state:BEG_AUTO  param:Sources -->
The source code license is GPL
The following source files are part of this tool:

|Source File|Comment|
|---|---|
|[cpp/ams_sendtest.cpp](/cpp/ams_sendtest.cpp)||
|[cpp/gen/ams_sendtest_gen.cpp](/cpp/gen/ams_sendtest_gen.cpp)||
|[include/ams_sendtest.h](/include/ams_sendtest.h)||
|[include/gen/ams_sendtest_gen.h](/include/gen/ams_sendtest_gen.h)||
|[include/gen/ams_sendtest_gen.inl.h](/include/gen/ams_sendtest_gen.inl.h)||

<!-- dev.mdmark  mdmark:MDSECTION  state:END_AUTO  param:Sources -->

### Dependencies
<a href="#dependencies"></a>
<!-- dev.mdmark  mdmark:MDSECTION  state:BEG_AUTO  param:Dependencies -->
The build target depends on the following libraries
|Target|Comment|
|---|---|
|[algo_lib](/txt/lib/algo_lib/README.md)|Support library for all executables|
|[lib_ams](/txt/lib/lib_ams/README.md)|Library for AMS middleware, supporting file format & messaging|

<!-- dev.mdmark  mdmark:MDSECTION  state:END_AUTO  param:Dependencies -->

### In Memory DB
<a href="#in-memory-db"></a>
<!-- dev.mdmark  mdmark:MDSECTION  state:BEG_AUTO  param:Imdb -->
`ams_sendtest` generated code creates the tables below.
All allocations are done through global `ams_sendtest::_db` [ams_sendtest.FDb](#ams_sendtest-fdb) structure
|Ctype|Ssimfile|Create|Access|
|---|---|---|---|
|[ams_sendtest.AmsSendTest](#ams_sendtest-amssendtest)||
|[ams_sendtest.FChild](#ams_sendtest-fchild)||FDb.child (Lary)|child (Lary, by rowid)|
|[ams_sendtest.FDb](#ams_sendtest-fdb)||FDb._db (Global)|

#### ams_sendtest.AmsSendTest - 
<a href="#ams_sendtest-amssendtest"></a>

#### ams_sendtest.AmsSendTest Fields
<a href="#ams_sendtest-amssendtest-fields"></a>
|Field|[Type](/txt/ssimdb/dmmeta/ctype.md)|[Reftype](/txt/ssimdb/dmmeta/reftype.md)|Default|Comment|
|---|---|---|---|---|
|ams_sendtest.AmsSendTest.n_msg_send|u64|[Val](/txt/exe/amc/reftypes.md#val)||Number of messages sent|
|ams_sendtest.AmsSendTest.off_send|u64|[Val](/txt/exe/amc/reftypes.md#val)||Offset sent|
|ams_sendtest.AmsSendTest.off_recv|u64|[Val](/txt/exe/amc/reftypes.md#val)||Offset received|
|ams_sendtest.AmsSendTest.n_msg_recv|u64|[Val](/txt/exe/amc/reftypes.md#val)||Number of messages received|
|ams_sendtest.AmsSendTest.n_write_wait|u64|[Val](/txt/exe/amc/reftypes.md#val)||Number of waits by parent|
|ams_sendtest.AmsSendTest.n_msg_limit|u64|[Val](/txt/exe/amc/reftypes.md#val)|1000000|Limit of messages to send|
|ams_sendtest.AmsSendTest.h_write|[algo_lib.FTimehook](/txt/lib/algo_lib/README.md#algo_lib-ftimehook)|[Val](/txt/exe/amc/reftypes.md#val)|||
|ams_sendtest.AmsSendTest.sum_recv_latency|u64|[Val](/txt/exe/amc/reftypes.md#val)|||

#### Struct AmsSendTest
<a href="#struct-amssendtest"></a>
Generated by [amc](/txt/exe/amc/README.md) into [include/gen/ams_sendtest_gen.h](/include/gen/ams_sendtest_gen.h)
```
struct AmsSendTest { // ams_sendtest.AmsSendTest
    u64                   n_msg_send;         //   0  Number of messages sent
    u64                   off_send;           //   0  Offset sent
    u64                   off_recv;           //   0  Offset received
    u64                   n_msg_recv;         //   0  Number of messages received
    u64                   n_write_wait;       //   0  Number of waits by parent
    u64                   n_msg_limit;        //   1000000  Limit of messages to send
    algo_lib::FTimehook   h_write;            //
    u64                   sum_recv_latency;   //   0
    // func:ams_sendtest.AmsSendTest..Ctor
    inline               AmsSendTest() __attribute__((nothrow));
};
```

#### ams_sendtest.FChild - 
<a href="#ams_sendtest-fchild"></a>

#### ams_sendtest.FChild Fields
<a href="#ams_sendtest-fchild-fields"></a>
|Field|[Type](/txt/ssimdb/dmmeta/ctype.md)|[Reftype](/txt/ssimdb/dmmeta/reftype.md)|Default|Comment|
|---|---|---|---|---|
|ams_sendtest.FChild.child|[command.ams_sendtest](/txt/protocol/command/README.md#command-ams_sendtest)|[Exec](/txt/exe/amc/reftypes.md#exec)|||
|ams_sendtest.FChild.proc_id|[ams.ProcId](/txt/protocol/ams/ProcId.md)|[Val](/txt/exe/amc/reftypes.md#val)|||

#### Struct FChild
<a href="#struct-fchild"></a>
Generated by [amc](/txt/exe/amc/README.md) into [include/gen/ams_sendtest_gen.h](/include/gen/ams_sendtest_gen.h)
```
struct FChild { // ams_sendtest.FChild
    algo::cstring           child_path;      //   "bin/ams_sendtest"  path for executable
    command::ams_sendtest   child_cmd;       // command line for child process
    algo::cstring           child_fstdin;    // redirect for stdin
    algo::cstring           child_fstdout;   // redirect for stdout
    algo::cstring           child_fstderr;   // redirect for stderr
    pid_t                   child_pid;       //   0  pid of running child process
    i32                     child_timeout;   //   0  optional timeout for child process
    i32                     child_status;    //   0  last exit status of child process
    ams::ProcId             proc_id;         //
private:
    // func:ams_sendtest.FChild..Ctor
    inline               FChild() __attribute__((nothrow));
    // func:ams_sendtest.FChild..Dtor
    inline               ~FChild() __attribute__((nothrow));
    friend ams_sendtest::FChild& child_Alloc() __attribute__((__warn_unused_result__, nothrow));
    friend ams_sendtest::FChild* child_AllocMaybe() __attribute__((__warn_unused_result__, nothrow));
    friend void                 child_RemoveAll() __attribute__((nothrow));
    friend void                 child_RemoveLast() __attribute__((nothrow));
};
```

#### ams_sendtest.FDb - In-memory database for ams_sendtest
<a href="#ams_sendtest-fdb"></a>

#### ams_sendtest.FDb Fields
<a href="#ams_sendtest-fdb-fields"></a>
|Field|[Type](/txt/ssimdb/dmmeta/ctype.md)|[Reftype](/txt/ssimdb/dmmeta/reftype.md)|Default|Comment|
|---|---|---|---|---|
|ams_sendtest.FDb.c_out|[lib_ams.FShm](/txt/lib/lib_ams/README.md#lib_ams-fshm)|[Ptr](/txt/exe/amc/reftypes.md#ptr)||Output goes here|
|ams_sendtest.FDb._db|[ams_sendtest.FDb](/txt/exe/ams_sendtest/internals.md#ams_sendtest-fdb)|[Global](/txt/exe/amc/reftypes.md#global)|||
|ams_sendtest.FDb.cmdline|[command.ams_sendtest](/txt/protocol/command/README.md#command-ams_sendtest)|[Val](/txt/exe/amc/reftypes.md#val)|||
|ams_sendtest.FDb.ams_send_test|[ams_sendtest.AmsSendTest](/txt/exe/ams_sendtest/internals.md#ams_sendtest-amssendtest)|[Val](/txt/exe/amc/reftypes.md#val)|||
|ams_sendtest.FDb.child|[ams_sendtest.FChild](/txt/exe/ams_sendtest/internals.md#ams_sendtest-fchild)|[Lary](/txt/exe/amc/reftypes.md#lary)|||

#### Struct FDb
<a href="#struct-fdb"></a>
Generated by [amc](/txt/exe/amc/README.md) into [include/gen/ams_sendtest_gen.h](/include/gen/ams_sendtest_gen.h)
```
struct FDb { // ams_sendtest.FDb: In-memory database for ams_sendtest
    lib_ams::FShm*              c_out;            // Output goes here. optional pointer
    command::ams_sendtest       cmdline;          //
    ams_sendtest::AmsSendTest   ams_send_test;    //
    ams_sendtest::FChild*       child_lary[32];   // level array
    i32                         child_n;          // number of elements in array
    ams_sendtest::trace         trace;            //
};
```

<!-- dev.mdmark  mdmark:MDSECTION  state:END_AUTO  param:Imdb -->

