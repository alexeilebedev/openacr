## gcache - Internals


### Table Of Contents
<a href="#table-of-contents"></a>
<!-- dev.mdmark  mdmark:MDSECTION  state:BEG_AUTO  param:Toc -->
* [Description](#description)
* [Sources](#sources)
* [Dependencies](#dependencies)
* [In Memory DB](#in-memory-db)

<!-- dev.mdmark  mdmark:MDSECTION  state:END_AUTO  param:Toc -->

### Description
<a href="#description"></a>
<!-- dev.mdmark  mdmark:MDSECTION  state:BEG_AUTO  param:Description -->
for usage, see [gcache - Compiler cache](/txt/exe/gcache/README.md)

<!-- dev.mdmark  mdmark:MDSECTION  state:END_AUTO  param:Description -->

### Sources
<a href="#sources"></a>
<!-- dev.mdmark  mdmark:MDSECTION  state:BEG_AUTO  param:Sources -->
The source code license is GPL
The following source files are part of this tool:

|Source File|Comment|
|---|---|
|[cpp/gcache/gcache.cpp](/cpp/gcache/gcache.cpp)||
|[cpp/gen/gcache_gen.cpp](/cpp/gen/gcache_gen.cpp)||
|[include/gcache.h](/include/gcache.h)||
|[include/gen/gcache_gen.h](/include/gen/gcache_gen.h)||
|[include/gen/gcache_gen.inl.h](/include/gen/gcache_gen.inl.h)||

<!-- dev.mdmark  mdmark:MDSECTION  state:END_AUTO  param:Sources -->

### Dependencies
<a href="#dependencies"></a>
<!-- dev.mdmark  mdmark:MDSECTION  state:BEG_AUTO  param:Dependencies -->
The build target depends on the following libraries
|Target|Comment|
|---|---|
|[algo_lib](/txt/lib/algo_lib/README.md)|Support library for all executables|

<!-- dev.mdmark  mdmark:MDSECTION  state:END_AUTO  param:Dependencies -->

### In Memory DB
<a href="#in-memory-db"></a>
<!-- dev.mdmark  mdmark:MDSECTION  state:BEG_AUTO  param:Imdb -->
`gcache` generated code creates the tables below.
All allocations are done through global `gcache::_db` [gcache.FDb](#gcache-fdb) structure
|Ctype|Ssimfile|Create|Access|
|---|---|---|---|
|[gcache.cleanreport](#gcache-cleanreport)||
|[gcache.FDb](#gcache-fdb)||FDb._db (Global)|
|[gcache.FHeader](#gcache-fheader)||FDb.header (Lary)|header (Lary, by rowid)|
||||FHeader.parent (Ptr)|

#### gcache.cleanreport - 
<a href="#gcache-cleanreport"></a>

#### gcache.cleanreport Fields
<a href="#gcache-cleanreport-fields"></a>
|Field|[Type](/txt/ssimdb/dmmeta/ctype.md)|[Reftype](/txt/ssimdb/dmmeta/reftype.md)|Default|Comment|
|---|---|---|---|---|
|gcache.cleanreport.n_cachefile|i32|[Val](/txt/exe/amc/reftypes.md#val)||Number of files in a cache|
|gcache.cleanreport.n_cachefile_del|i32|[Val](/txt/exe/amc/reftypes.md#val)||Number of files deleted|
|gcache.cleanreport.n_cachefile_recent|i32|[Val](/txt/exe/amc/reftypes.md#val)||Number of files recently accessed|
|gcache.cleanreport.n_logline|i32|[Val](/txt/exe/amc/reftypes.md#val)||Number of log lines|
|gcache.cleanreport.n_logline_del|i32|[Val](/txt/exe/amc/reftypes.md#val)||Number of log lines deleted|
|gcache.cleanreport.new_cachesize_mb|i64|[Val](/txt/exe/amc/reftypes.md#val)||New cache size in MB|

#### Struct cleanreport
<a href="#struct-cleanreport"></a>
Generated by [amc](/txt/exe/amc/README.md) into [include/gen/gcache_gen.h](/include/gen/gcache_gen.h)
```
struct cleanreport { // gcache.cleanreport
    i32   n_cachefile;          //   0  Number of files in a cache
    i32   n_cachefile_del;      //   0  Number of files deleted
    i32   n_cachefile_recent;   //   0  Number of files recently accessed
    i32   n_logline;            //   0  Number of log lines
    i32   n_logline_del;        //   0  Number of log lines deleted
    i64   new_cachesize_mb;     //   0  New cache size in MB
    // func:gcache.cleanreport..Ctor
    inline               cleanreport() __attribute__((nothrow));
    // func:gcache.cleanreport..FieldwiseCtor
    explicit inline               cleanreport(i32 in_n_cachefile, i32 in_n_cachefile_del, i32 in_n_cachefile_recent, i32 in_n_logline, i32 in_n_logline_del, i64 in_new_cachesize_mb) __attribute__((nothrow));
};
```

#### gcache.FDb - In-memory database for gcache
<a href="#gcache-fdb"></a>

#### gcache.FDb Fields
<a href="#gcache-fdb-fields"></a>
|Field|[Type](/txt/ssimdb/dmmeta/ctype.md)|[Reftype](/txt/ssimdb/dmmeta/reftype.md)|Default|Comment|
|---|---|---|---|---|
|gcache.FDb.report|[report.gcache](/txt/protocol/report/README.md#report-gcache)|[Val](/txt/exe/amc/reftypes.md#val)||Final report|
|gcache.FDb.cleanreport|[gcache.cleanreport](/txt/exe/gcache/internals.md#gcache-cleanreport)|[Val](/txt/exe/amc/reftypes.md#val)|||
|gcache.FDb._db|[gcache.FDb](/txt/exe/gcache/internals.md#gcache-fdb)|[Global](/txt/exe/amc/reftypes.md#global)|||
|gcache.FDb.cmdline|[command.gcache](/txt/protocol/command/README.md#command-gcache)|[Val](/txt/exe/amc/reftypes.md#val)|||
|gcache.FDb.dir|[algo.cstring](/txt/protocol/algo/cstring.md)|[Val](/txt/exe/amc/reftypes.md#val)|||
|gcache.FDb.do_not_compile|bool|[Val](/txt/exe/amc/reftypes.md#val)|||
|gcache.FDb.do_not_link|bool|[Val](/txt/exe/amc/reftypes.md#val)|||
|gcache.FDb.do_not_assemble|bool|[Val](/txt/exe/amc/reftypes.md#val)|||
|gcache.FDb.target|[algo.cstring](/txt/protocol/algo/cstring.md)|[Val](/txt/exe/amc/reftypes.md#val)|||
|gcache.FDb.cached|[algo.cstring](/txt/protocol/algo/cstring.md)|[Val](/txt/exe/amc/reftypes.md#val)|||
|gcache.FDb.logfname|[algo.cstring](/txt/protocol/algo/cstring.md)|[Val](/txt/exe/amc/reftypes.md#val)|||
|gcache.FDb.preproc_file|[algo.cstring](/txt/protocol/algo/cstring.md)|[Val](/txt/exe/amc/reftypes.md#val)|||
|gcache.FDb.header|[gcache.FHeader](/txt/exe/gcache/internals.md#gcache-fheader)|[Lary](/txt/exe/amc/reftypes.md#lary)|||
|gcache.FDb.preproc_text|[algo.cstring](/txt/protocol/algo/cstring.md)|[Val](/txt/exe/amc/reftypes.md#val)|||
|gcache.FDb.lockfd|[algo_lib.FFildes](/txt/lib/algo_lib/README.md#algo_lib-ffildes)|[Val](/txt/exe/amc/reftypes.md#val)|||

#### Struct FDb
<a href="#struct-fdb"></a>
Generated by [amc](/txt/exe/amc/README.md) into [include/gen/gcache_gen.h](/include/gen/gcache_gen.h)
```
struct FDb { // gcache.FDb: In-memory database for gcache
    report::gcache        report;            // Final report
    gcache::cleanreport   cleanreport;       //
    command::gcache       cmdline;           //
    algo::cstring         dir;               //
    bool                  do_not_compile;    //   false
    bool                  do_not_link;       //   false
    bool                  do_not_assemble;   //   false
    algo::cstring         target;            //
    algo::cstring         cached;            //
    algo::cstring         logfname;          //
    algo::cstring         preproc_file;      //
    gcache::FHeader*      header_lary[32];   // level array
    i32                   header_n;          // number of elements in array
    algo::cstring         preproc_text;      //
    algo_lib::FFildes     lockfd;            //
    gcache::trace         trace;             //
};
```

#### gcache.FHeader - 
<a href="#gcache-fheader"></a>

#### gcache.FHeader Fields
<a href="#gcache-fheader-fields"></a>
|Field|[Type](/txt/ssimdb/dmmeta/ctype.md)|[Reftype](/txt/ssimdb/dmmeta/reftype.md)|Default|Comment|
|---|---|---|---|---|
|gcache.FHeader.parent|[gcache.FHeader](/txt/exe/gcache/internals.md#gcache-fheader)|[Ptr](/txt/exe/amc/reftypes.md#ptr)|||
|gcache.FHeader.name|[algo.cstring](/txt/protocol/algo/cstring.md)|[Val](/txt/exe/amc/reftypes.md#val)|||
|gcache.FHeader.begin|i32|[Val](/txt/exe/amc/reftypes.md#val)|||
|gcache.FHeader.inner_end|i32|[Val](/txt/exe/amc/reftypes.md#val)|||
|gcache.FHeader.outer_end|i32|[Val](/txt/exe/amc/reftypes.md#val)|||
|gcache.FHeader.mlines_before|bool|[Val](/txt/exe/amc/reftypes.md#val)|||

#### Struct FHeader
<a href="#struct-fheader"></a>
Generated by [amc](/txt/exe/amc/README.md) into [include/gen/gcache_gen.h](/include/gen/gcache_gen.h)
```
struct FHeader { // gcache.FHeader
    gcache::FHeader*   parent;          // optional pointer
    algo::cstring      name;            //
    i32                begin;           //   0
    i32                inner_end;       //   0
    i32                outer_end;       //   0
    bool               mlines_before;   //   false
private:
    // func:gcache.FHeader..Ctor
    inline               FHeader() __attribute__((nothrow));
    friend gcache::FHeader&     header_Alloc() __attribute__((__warn_unused_result__, nothrow));
    friend gcache::FHeader*     header_AllocMaybe() __attribute__((__warn_unused_result__, nothrow));
    friend void                 header_RemoveAll() __attribute__((nothrow));
    friend void                 header_RemoveLast() __attribute__((nothrow));
};
```

<!-- dev.mdmark  mdmark:MDSECTION  state:END_AUTO  param:Imdb -->

